---
title: "BC Climate: temperature and precipitation anomalies and trend"
author:
 name: "Aseem Sharma e-mail: aseem.sharma@gov.bc.ca"
 corresponding: true
 email: Aseem.Sharma@gov.bc.ca
 affiliations:
    id: "FFEC"
    name: "Future Forest Ecosystems Centre, FCCSB, OCF, BC Ministry of Forests" 
date: "`r paste('Date:', format(Sys.time(), '%d %B, %Y'))`"
toc: true
toc-depth: 4
toc-title: "Contents"
code-annotations: false
execute:
  echo: false
  warning: false
  output: false
cap-location: bottom
editor: visual
wrap: auto
format: 
 html:
  fig-format: png
  toc_float: true
  toc-location: left
  number-sections: false
  embed-resources: true
  self-contained: true
 # pdf:
 #  lof: true
 #  lot: false
 #  number-sections: false
 #  fig-pos: 'H'
 #  fig-format: png
 #  fig-dpi: 150
 #  pdf-engine: latexmk
 #  pdf-engine-opt: -xelatex
editor_options: 
 chunk_output_type: console
---

```{r required}
#| include: false
#| results: hold
#| cache: true

# Required -------------------------------
rqr_pkgs <-
  c(
    'terra',
    'sf',
    "tidyverse",
    'lubridate',
    'zoo',
    'magrittr',
    "Kendall",
    "zyp",
    "tidyterra",
    "colorspace",
    "cptcity",
    "quarto"
  )
# Install packages if not
installed_rqr_pkgs <- rqr_pkgs %in% rownames(installed.packages())
if (any(installed_rqr_pkgs == FALSE)) {
  install.packages(rqr_pkgs[!installed_rqr_pkgs])
}
# Load:
lapply(rqr_pkgs , require, character.only = TRUE)

# setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
```

```{r paths}
#| include: false
#| results: 'hold'
#| cache: true
# Paths ------------------------
# setwd(getwd())
shp_fls_pth <- '../shapefiles/'
ano_dt_pth <-  '../ano_clm_data/'
```

```{r datafiles}
#| include: false
#| cache: true

# Data files ------------------
# Shape files --------------------------------
# Domain Shape files
xmi = -140
xmx = -108
ymi = 39
ymx = 60

# List of shape files
list.files(path = shp_fls_pth,
           pattern = ".shp",
           full.names = T) -> shp_fls_lst
shp_fls_lst

# BC
bc_shp <- st_read(shp_fls_lst[str_detect(shp_fls_lst,"bc_shapefile")== T])
# plot(st_geometry(bc_shp))

# BC eco-regions
bc_ecoprv_shp <- st_read(shp_fls_lst[str_detect(shp_fls_lst,"bc_ecoprovince")== T])
# plot(st_geometry(bc_ecoprv_shp))

# BC watersheds
bc_wtrshd_shp <- st_read(shp_fls_lst[str_detect(shp_fls_lst,"bc_watersheds")== T])
# plot(st_geometry(bc_wtrshd_shp))

# Western North America

na_shp <- st_read(shp_fls_lst[str_detect(shp_fls_lst,"north_america")== T])
sf_use_s2(FALSE)
wna_shp <-
  st_crop(
    na_shp,
    xmin = xmi,
    ymin = ymi,
    xmax = xmx,
    ymax = ymx
  )
# plot(st_geometry(wna_shp))

## Months, parameters ----
months_nam <-
  c(
    "annual",
    "winter",
    "spring",
    "summer",
    "fall",
    "Jan",
    "Feb",
    "Mar",
    "Apr",
    "May",
    "Jun",
    "Jul",
    "Aug",
    "Sep",
    "Oct",
    "Nov",
    "Dec"
  )
months_nam

parameters <- c("tmean", "tmax", "tmin", "prcp")
parameters

min_year <- 1951
max_year <- 2023

update_month <- "September"
update_year <- "2023"

years <- seq(min_year, max_year, 1)
years

## Anomalies Data files -----
list.files(path = ano_dt_pth,
           pattern = ".*_ano_.*\\.nc",
           full.names = T) -> ano_dt_fls
head(ano_dt_fls)

ano_dt_fl <- tibble(dt_pth = ano_dt_fls)
ano_dt_fl %<>%
  mutate(mon = str_extract(ano_dt_fls,
                           paste(months_nam, collapse = "|")),
         par = str_extract(ano_dt_fls,
                           paste(parameters, collapse = "|")))

## Climatology Data files -----
list.files(path = ano_dt_pth,
           pattern = ".*_clm_.*\\.nc",
           full.names = T) -> clm_dt_fls
head(clm_dt_fls)

clm_dt_fl <- tibble(dt_pth = clm_dt_fls)
clm_dt_fl %<>%
  mutate(par = str_extract(clm_dt_fls,
                           paste(parameters, collapse = "|")))

# Spatial average analysis for BC
sel_area_shpfl <- bc_shp
sel_area <- "BC"
```

# Recent months/seasons Summary

## Summer 2023

-   The summer (June, July & August) of 2023 stood out as one of the warmest seasons in BC, featuring an average mean temperature anomaly of 2.30°C above the normal baseline (ranging spatially from 0.52°C to 3.17°C).

-   The spatially averaged BC's total summer precipitation in 2023 was 21% lower than the historical average. Particularly, Vancouver Island and the Lower Mainland experienced a significant deficit, receiving up to 67% less precipitation than the usual seasonal norms

-   Notably, June and August exhibited extreme dryness in Vancouver Island, the Lower Mainland, and higher latitude regions of BC. Meanwhile, July was characterized by an extended dry spell, with precipitation levels plummeting by up to 82% below the normal for lower latitude regions.

# Overall Summary: 1980 - 2022

This report presents a comprehensive analysis of monthly and annual anomalies in mean, maximum, and minimum temperatures, as well as precipitation data for the period from 1980 to 2023 in western North America. Additionally, it examines the spatially averaged trends in monthly and annual temperature and precipitation for British Columbia (BC) during the same period. The study utilizes ERA5 land data with a spatial resolution of approximately 9 km × 9 km and calculates anomalies relative to the climatological mean of 1981 to 2010. Anomalies were obtained by subtracting the climatological mean from the corresponding monthly and annual temperature and precipitation values. The magnitudes of trends and their statistical significance are determined using the non-parametric Mann-Kendall trend test.

-   January have been warmer in recent years (except 2020), particularly in the higher latitude region, including BC, with temperatures above 10°C above average in some areas.

-   On average, BC's mean January temperature has increased by 2.64°C over the last four decades.

-   Overall, January precipitation has increased in BC, with a higher increase in the coastal region and Vancouver Island.

-   February experiences up to 15°C lower mean temperatures than normal in some areas within western North America (WNA).

-   In BC, the average February temperature does not show a significant change over time.

-   Interestingly, there is a decreasing trend in the mean temperature for BC in March, with large negative anomalies occurring in years 2017, 2018, 2020, and 2023, corresponding to La Niña years.

-   BC's average total precipitation increases significantly in March (*p-value* \< 0.1), with higher anomalies occurring mostly along Vancouver Island and the lower mainland.

-   2022 was one of the coolest Aprils in recent decades, with an overall slightly decreasing trend in mean temperature across BC.

-   Every summer month (May, June, July, and August) exhibits greater temperature anomalies in recent years compared to previous years, with up to 8°C positive anomalies in some regions.

-   Since 2012, every May has been warmer than previous years except 2022. The BC's average May temperatures have significantly increased by 2.2°C over the last 44 years.

-   May summer precipitation shows negative anomalies, especially in northern regions, with an overall insignificant decreasing trend in BC.

-   Similar temperature patterns as May are observed for June, July, and August; the rate of temperature increase is statistically significant for July and August, with an increasing rate of 0.03°C per year.

-   The precipitation pattern reverses from May to June, with positive anomalies for most higher latitude regions except for the years 2015 and 2021. There has been no significant change in BC's June precipitation amount over the last 44 years.

-   July, a dry month, has become drier, especially in lower latitude regions in recent years. July's BC average total precipitation decreases by 26% from the climatological average over the past 44 years, with regional variability between lower and higher latitude regions.

-   August precipitation is also lower than normal for most areas except coastal and higher latitude regions of BC.

-   Mean September and October temperatures exhibit positive anomalies for most of WNA, but with some year-to-year variations.

-   The average BC temperature increases by 0.03 and 0.04°C per year for September and October, respectively.

-   September precipitation has increased in BC in recent years, however with regional variability. October shows large positive and negative anomalies along lower and higher latitude regions of WNA in recent years. There is no significant change in average October precipitation in BC.

-   November's average temperature shows positive anomalies, with some years reporting up to a 13°C increase in monthly temperature from normal (e.g., 2016).

-   The average November temperature in BC increases significantly at a rate of 0.05°C per year.

-   November precipitation indicates large regional variability, with more than normal precipitation along the lower mainland and Pacific Northwest (PNW) while less than normal for most of the higher latitude region. Overall, the total average BC precipitation increases.

-   Substantial variability occurs in December mean temperature across WNA. There is no substantial change in the average monthly December temperature in BC.

-   On an annual basis, WNA experiences positive anomalies for most recent years, especially after 2013, with 2015 and 2016 being the warmest so far.

-   The average annual temperature of BC increases at a rate of 0.02°C per year (*p-value* = 0.09).

-   Annual total precipitation shows strong regional and year-to-year variability, but overall total precipitation increases in WNA and BC.

-   The positive and negative anomalies in temperature closely follow the pattern of ENSO circulation, with El Niño years showing warmer anomalies and La Niña showing cooler anomalies.

```{r plot_funtion}
#| include: false
#| cache: true

# Anomalies analysis and plots --------------
#For plot
months_nam

# #Colorspace
# hcl_palettes(plot = TRUE)
# hcl_palettes("Diverging",n=20,plot=T)
# divergingx_palettes(plot=T,n=21)

# This function reads anomaly, absolute and climate value data in csv format for WNA, plot spatial anomaly,
#convert data frame to raster and clip the raster to defined shape file ( e.g., BC)
# does spatial average and calculate spatial average trend and make a plot for Annual and each months.

# i <- 41
ano_ana_plt_fun <- function(ano_dt_fls, spatial_plt=T, spatial_av = T,test_plt = F) {

  # ano_dt_fls <- ano_dt_fl[i,]
  ano_dt_fls
  ano_dt_rast50 <- rast(ano_dt_fls$dt_pth)
  #Only for 1980 onwards
  ano_dt_rast <- subset(ano_dt_rast50,31:nlyr(ano_dt_rast50))
  # plot(ano_dt_rast)
  yr_df <- tibble(paryr = names(ano_dt_rast))
  yr_df %<>%
    mutate(yr = as.numeric(str_extract(paryr, "[0-9]+")))%>%
    filter(yr >1979)
  yr_df
  parr <- unique(ano_dt_fls$par)
  monn <- unique(ano_dt_fls$mon)
  mon <- unique(ano_dt_fls$mon)
  
    if (parr == 'tmin') {
      parr_full = "Minimum temperature"
    } else if (parr == 'tmax') {
      parr_full = "Maximum temperature"
    } else if (parr == 'tmean') {
      parr_full = "Mean temperature"
    } else if (parr == 'prcp') {
      parr_full = "Total precipitation"
    }
    parr_full

    if (monn == 'annual') {
      monn_full = "Annual"
    } else if (monn == 'spring') {
      monn_full = "Spring"
    } else if (monn == 'summer') {
      monn_full = "Summer"
    } else if (monn == 'fall') {
      monn_full = "Fall"
    } else if (monn == 'winter') {
      monn_full = "Winter"
    } else if (monn == 'Jan') {
      monn_full = "Janaury"
    } else if (monn == 'Feb') {
      monn_full = "February"
    } else if (monn == 'Mar') {
      monn_full = "March"
    } else if (monn == 'Apr') {
      monn_full = "April"
    } else if (monn == 'May') {
      monn_full = "May"
    } else if (monn == 'Jun') {
      monn_full = "June"
    } else if (monn == 'Jul') {
      monn_full = "July"
    } else if (monn == 'Aug') {
      monn_full = "August"
    } else if (monn == 'Sep') {
      monn_full = "September"
    } else if (monn == 'Oct') {
      monn_full = "October"
    } else if (monn == 'Nov') {
      monn_full = "November"
    } else if (monn == 'Dec') {
      monn_full = "December"
    }
    monn_full

   # Anomaly plot by years
  minyr  <- min(yr_df$yr)
  maxyr  <- max(yr_df$yr)

  # Calculate % of normal anomaly for precipitation
  # Import climatology and calculate % anomaly for precipitation
    names(ano_dt_rast)
    
    clm_dt_fl %>%
      filter(par == parr) -> clm_dt_fl_par
    clm_dt_sel_rast <- rast(clm_dt_fl_par$dt_pth)
    names(clm_dt_sel_rast) <- months_nam
    clm_dt_sel_rast_mon <-
      subset(clm_dt_sel_rast, which(names(clm_dt_sel_rast) %in% monn))
    clm_dt_sel_rast <- clm_dt_sel_rast_mon
    rm(clm_dt_sel_rast_mon)
    # plot(clm_dt_sel_rast)
    # plot(ano_dt_rast)

    if (parr == 'prcp') {
      ano_dt_rast_per1 <- (ano_dt_rast / clm_dt_sel_rast) * 100
      #If prcp anomalies are very high ( > 200 %) then convert and limit to 200.
      ano_dt_rast_per2 <-
        ifel(ano_dt_rast_per1 > 201, 200, ano_dt_rast_per1)
      ano_dt_rast_per3 <-
        ifel(ano_dt_rast_per2 < -201, -200, ano_dt_rast_per2)
      ano_dt_rast <- ano_dt_rast_per3
    } else{
      ano_dt_rast <- ano_dt_rast
    }
    # plot(ano_dt_rast,40:44)
    ano_dt_rast

    ano_rng_lmt <- terra::minmax(ano_dt_rast, compute = T)
    minval <- (-1) * (max(abs(ano_rng_lmt), na.rm = T))
    maxval <- (1) * (max(abs(ano_rng_lmt), na.rm = T))
   names(ano_dt_rast) <- yr_df$yr
   
       # units
    if (parr == "tmax" | parr == "tmin" | parr == "tmean") {
      unt <- "(°C)"
    } else if (parr == "prcp") {
      unt <- "(% of normal)"
      parr_pr <- "prcp"
    } else if (parr == "RH") {
      unt <- "(%)"
    } else {
      unt <- ""
    }
    unt

    # Breaks and labels
    brk_neg <-
      ceiling(c(seq(minval, 0, length.out = 4)))
    brk_pos <-
      floor(c(seq(0, maxval, length.out = 4)))[-1]

    #create breaks with "00"

    if (nchar(abs(brk_neg[[1]])) == 4) {
      brk_negn <- plyr::round_any(brk_neg, 100, f = ceiling)
    } else if (nchar(abs(brk_neg[[1]])) == 3) {
      brk_negn <- plyr::round_any(brk_neg, 10, f = ceiling)
    } else if (nchar(abs(brk_neg[[1]])) == 2) {
      brk_negn <- plyr::round_any(brk_neg, 1, f = ceiling)
    } else if (nchar(abs(brk_neg[[1]])) == 1) {
      brk_negn <- plyr::round_any(brk_neg, 1, f = ceiling)
    }
    brk_negn

    if (nchar(abs(brk_neg[[1]])) == 4) {
      brk_posp <- plyr::round_any(brk_pos, 100, f = floor)
    } else if (nchar(abs(brk_neg[[1]])) == 3) {
      brk_posp <- plyr::round_any(brk_pos, 10, f = floor)
    } else if (nchar(abs(brk_pos[[1]])) == 2) {
      brk_posp <- plyr::round_any(brk_pos, 1, f = floor)
    } else if (nchar(abs(brk_pos[[1]])) == 1) {
      brk_posp <- plyr::round_any(brk_pos, 1, f = floor)
    }
    brk_posp

    brks_seq <- c(brk_negn, brk_posp)
    labels_val <- c(
      paste0("<", brks_seq[[1]]),
      brks_seq[[2]],
      brks_seq[[3]],
      brks_seq[[4]],
      brks_seq[[5]],
      brks_seq[[6]],
      paste0(">", brks_seq[[7]])
    )
    labels_val

    # Plot using terra rast
    # Climate plot title ( use log for prcp)
    if (parr == "prcp") {
      par_title <-  paste0(
                           parr_full, " anomaly (% of normal)",
                           " : ",
                           monn_full)
    } else {
      par_title <-  paste0(
                           parr_full, " anomaly ", unt,
                           " : ",
                           monn_full)
    }
    
     plt_wtrmrk <-
      "Created by Aseem Sharma, BC Ministry of Forests using ERA5-Land hourly data. Contact: Aseem.Sharma@gov.bc.ca"
    plt_wtrmrk

    spatial_ano_plt <-  ggplot() +
      geom_spatraster(data = ano_dt_rast) +
      scale_fill_gradientn(
        name = paste0(parr, " anomaly ", unt),
        colours = cpt(pal = "ncl_BlWhRe",
                      n = 100,
                      rev = F),
        na.value = "transparent",
        limits = c(minval, maxval),
        breaks = brks_seq
      ) +
      facet_wrap(. ~ lyr, ncol = 10)+
    scale_x_continuous(
      name =  "Longitude (°W) ",
      breaks = seq(xmi - 5, xmx + 5, 10),
      labels = abs,
      expand = c(0, 0)
    ) +
    scale_y_continuous(
      name = "Latitude (°N) ",
      breaks = seq(ymi - 1, ymx + 1, 6),
      labels = abs,
      expand = c(0, 0)
    ) +
      geom_sf(
        data = wna_shp,
        colour = "gray40",
        fill = NA,
        alpha = 0.5
      ) +
      geom_sf(
        data = bc_shp,
        colour = "black",
        fill = NA,
        alpha = 0.8
      ) +
      coord_sf(
        xlim = c(xmi, xmx),
        ylim = c(ymi, ymx),
        # datum = st_crs(3005),
        expand = F
      )+
      theme_bw() +
      theme(
        panel.spacing = unit(0.1, "lines"),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_line(
          color = "gray75",
          linewidth = 0.05,
          linetype = "dashed"
        ),
        axis.line = element_line(colour = "black", linewidth = 1),
        axis.ticks.length = unit(-0.20, "cm"),
        element_line(colour = "black", linewidth =  1),
        axis.title.y = element_text(
          angle = 90,
          face = "plain",
          size = 15,
          colour = "Black",
          margin = unit(c(-1, -1, -1, -1), "mm")
        ),
        axis.title.x = element_text(
          angle = 0,
          face = "plain",
          size = 15,
          colour = "Black",
          margin = unit(c(-1, -1, -1, -1), "mm")
        ),
        axis.text.x = element_text(
          angle = 0,
          hjust = 0.5,
          vjust = 0.5,
          colour = "black",
          size = 14,
          margin = margin(
            t = 2,
            r = 2,
            b = 2,
            l = 2
          )
        ),
        axis.text.y = element_text(
          angle = 90,
          hjust = 0.5,
          vjust = 0.5,
          colour = "black",
          size = 14,
          margin = margin(
            t = 2,
            r = 2,
            b = 2,
            l = 2
          )
        ),
        plot.title = element_text(
          angle = 0,
          face = "bold",
          size = 15,
          colour = "Black"
        ),
        legend.position = c(0.70, 0.10),
        legend.direction = "horizontal",
        legend.margin = margin(0, 0, 0, 0),
        legend.box.margin = margin(-5, -5, -5, -5),
        legend.title = element_text(size = 14),
        legend.text = element_text(margin = margin(t = -5), size = 13),
        strip.text.x = element_text(size = 12, angle = 0),
        strip.text.y = element_text(size = 12, face = "bold"),
        axis.text = element_text(margin = -5),
        strip.background = element_rect(fill = "gray90"),
        strip.text = element_text(face="bold",size=15,colour = 'black')
      ) +
      guides(
        fill = guide_colorbar(
          barwidth = 25,
          barheight = 1.5,
          label.vjust = 0.0,
          label.hjust = 0.5,
          title.vjust = 0.9,
          title.hjust = 0.5,
          title.position = "top",
          ticks.colour = 'black',
          # ticks.linewidth = 1,
          frame.colour = 'black',
          # frame.linewidth = 1,
          # draw.ulim = FALSE,
          # draw.llim = TRUE,
        )
      ) +
      theme(
        axis.title.x = element_blank(),
        axis.text.x = element_blank(),
        axis.ticks.x = element_blank(),
        axis.title.y = element_blank(),
        axis.text.y = element_blank(),
        axis.ticks.y = element_blank()
      )
    if (parr == "prcp" & maxval > 200) {
      spatial_ano_plt <- spatial_ano_plt +
        scale_fill_gradientn(
          name = paste0(parr, " anomaly ", unt),
          colours = cpt(pal = "cmocean_curl",
                        n = 100,
                        rev = T),
          na.value = "transparent",
          limits = c(minval, maxval),
          breaks = brks_seq,
          labels = labels_val
        )
    } else if (parr == "prcp") {
      spatial_ano_plt <- spatial_ano_plt +
        scale_fill_gradientn(
          name = paste0(parr_pr, "  anomaly (%) "),
          colours = cpt(pal = "cmocean_curl",
                        n = 100,
                        rev = T),
          na.value = "transparent",
          limits = c(minval, maxval),
          breaks = brks_seq
        )
    }
    spatial_ano_plt <- spatial_ano_plt +
      labs(title = par_title, subtitle = "Baseline: 1981-2010",
           tag = plt_wtrmrk) +
      theme(
        plot.tag.position = "bottom",
        plot.tag = element_text(
          color = 'gray85',
          hjust = 1,
          size = 7
        )
      )
    # spatial_ano_plt
    # parr_ann_ano_plt
      # ggsave(
    #   paste0(
    #     results_pth,
    #     parr,
    #     "_",
    #     mon,
    #     "_anomaly_",
    #     minyr,
    #     "_",
    #     maxyr,
    #     ".png"
    #   ),
    #   plot = parr_ann_ano_plt,
    #   width = 15,
    #   height = 9,
    #   units = "in",
    #   dpi = 300,
    #   scale = 1.0,
    #   limitsize = F
    # )
  
  if (spatial_av){
    
    # Spatial average for given shape file ( e.g., BC) and trend plot
    ano_dt_rast50
    # plot(ano_dt_rast50,73:74)
    
      if (parr == 'prcp') {
      ano_dt_rast_per1 <- (ano_dt_rast50 / clm_dt_sel_rast) * 100
      #If prcp anomalies are very high ( > 200 %) then convert and limit to 200.
      ano_dt_rast_per2 <-
        ifel(ano_dt_rast_per1 > 201, 200, ano_dt_rast_per1)
      ano_dt_rast_per3 <-
        ifel(ano_dt_rast_per2 < -201, -200, ano_dt_rast_per2)
      ano_dt_rast50 <- ano_dt_rast_per3
    } else{
      ano_dt_rast50 <- ano_dt_rast50
    }
    # plot(ano_dt_rast50,40:44)
    ano_dt_rast50
    ano_dt_shp <-
      terra::crop(ano_dt_rast50, sel_area_shpfl, mask = T)
    ano_dt_shp
    # plot(ano_dt_shp)
   
    # Shape file spatial average anomalies by year
    ano_shp_av_dt <-
      tibble(rownames_to_column(global(
        ano_dt_shp, fun = "mean", na.rm = T
      ), "yrmn"))%>%
      dplyr::select(yrmn,ano=mean)
    tail(ano_shp_av_dt)
    ano_shp_av_dt%<>%
      drop_na()

    ano_shp_av_dt$yr <-as.numeric(str_extract(ano_shp_av_dt$yrmn, "[0-9]+"))
    ano_shp_av_dt$par <- parr
    ano_shp_av_dt$mon <- mon
    ano_shp_av_dt

     # Background requirements for plots
    region <- "BC"

    # units
    if (parr == "tmax" | parr == "tmin" | parr == "tmean") {
      unt <- "(°C)"
    } else if (parr == "prcp") {
      unt <- "(% of normal)"
      parr_pr <- "prcp"
    } else if (parr == "RH") {
      unt <- "(%)"
    } else {
      unt <- ""
    }
    unt

    # Trend on average anomaly 1950 - now
     ano_shp_av_dt %<>%
      filter(yr > 1950) %<>%
      mutate(# trnd =zyp.trend.vector(ano)[["trend"]],
        # incpt =zyp.trend.vector(ano)[["intercept"]],
        #sig = zyp.trend.vector(ano)[["sig"]])
        sig = round(MannKendall(ano)[[2]], digits = 2))
     ano_shp_av_dt

    ano_mk_trnd <-
      zyp.sen(ano ~ yr, ano_shp_av_dt)##Give the trend###
    ano_mk_trnd$coefficients
    ano_shp_av_dt$trn <-  ano_mk_trnd$coeff[[2]]
    ano_shp_av_dt$incpt <-  ano_mk_trnd$coeff[[1]]

    xs = c(min(ano_shp_av_dt$yr), max(ano_shp_av_dt$yr))
    trn_slp = c(unique(ano_shp_av_dt$incpt), unique(ano_shp_av_dt$trn))
    ys = cbind(1, xs) %*% trn_slp
    ano_shp_av_dt$trn_lab = paste(
      "italic(1951-trend)==",
      round(ano_shp_av_dt$trn, 2),
      "~','~italic(p)==",
      round(ano_shp_av_dt$sig, 2)
    )

    # Trend on average anomaly 1980 - now
    ano_shp_av_dt %>%
      filter(yr > 1979) %>%
      mutate(# trnd =zyp.trend.vector(ano)[["trend"]],
        # incpt =zyp.trend.vector(ano)[["intercept"]],
        #sig = zyp.trend.vector(ano)[["sig"]])
        sig = round(MannKendall(ano)[[2]], digits = 2)) -> ano_shp_av_dt80
    ano_shp_av_dt80

    ano_mk_trnd80 <-
      zyp.sen(ano ~ yr, ano_shp_av_dt80)##Give the trend###
    ano_mk_trnd80$coefficients
    ano_shp_av_dt80$trn <-  ano_mk_trnd80$coeff[[2]]
    ano_shp_av_dt80$incpt <-  ano_mk_trnd80$coeff[[1]]

    xs80 = c(min(ano_shp_av_dt80$yr), max(ano_shp_av_dt80$yr))
    trn_slp80 = c(unique(ano_shp_av_dt80$incpt), unique(ano_shp_av_dt80$trn))
    ys80 = cbind(1, xs80) %*% trn_slp80
    ano_shp_av_dt80$trn_lab = paste(
      "italic(1980-trend)==",
      round(ano_shp_av_dt80$trn, 2),
      "~','~italic(p)==",
      round(ano_shp_av_dt80$sig, 2)
    )

    # anomaly plot
    ymin <- (-1) * (max(abs(ano_shp_av_dt$ano)))
    ymax <- (1) * (max(abs(ano_shp_av_dt$ano)))
    minyr <- min(ano_shp_av_dt$yr)
    maxyr <- max(ano_shp_av_dt$yr)

    ybrk_neg <-
      ceiling(c(seq((-1) * (max(
        abs(ano_shp_av_dt$ano)
      )), 0, length.out = 4)))
    ybrk_neg
    ybrk_pos <-
      floor(c(seq(0, (1) * (max(
        abs(ano_shp_av_dt$ano)
      )), length.out = 4)))[-1]
    ybrk_pos

    #create breaks with "00"

    if (nchar(abs(ybrk_neg[[1]])) == 4) {
      ybrk_negn <- plyr::round_any(ybrk_neg, 100, f = ceiling)
    } else if (nchar(abs(ybrk_neg[[1]])) == 3) {
      ybrk_negn <- plyr::round_any(ybrk_neg, 10, f = ceiling)
    } else if (nchar(abs(ybrk_neg[[1]])) == 2) {
      ybrk_negn <- plyr::round_any(ybrk_neg, 1, f = ceiling)
    } else if (nchar(abs(ybrk_neg[[1]])) == 1) {
      ybrk_negn <- plyr::round_any(ybrk_neg, 1, f = ceiling)
    }
    ybrk_negn

    if (nchar(abs(ybrk_neg[[1]])) == 4) {
      ybrk_posp <- plyr::round_any(ybrk_pos, 100, f = floor)
    } else if (nchar(abs(ybrk_neg[[1]])) == 3) {
      ybrk_posp <- plyr::round_any(ybrk_pos, 10, f = floor)
    } else if (nchar(abs(ybrk_pos[[1]])) == 2) {
      ybrk_posp <- plyr::round_any(ybrk_pos, 1, f = floor)
    } else if (nchar(abs(ybrk_pos[[1]])) == 1) {
      ybrk_posp <- plyr::round_any(ybrk_pos, 1, f = floor)
    }
    ybrk_posp

    ybrks_seq <- c(ybrk_negn, ybrk_posp)

    # Positive and negative anomalies and 3 years moving average to create bar plot
    ano_shp_av_dt %<>%
      mutate(pos_neg = if_else(ano <= 0, "neg", "pos")) %>%
      mutate(ano_mv = rollmean(ano, 3, fill = list(NA, NULL, NA)))
    ano_shp_av_dt
    tail(ano_shp_av_dt)

    if (parr == "prcp") {
      par_title <-  paste0(region, " ",
                           parr_full, " (% of normal)",
                           " : ",
                           monn_full)
    } else{
      par_title <-  paste0(region, " ",
                           parr_full, " ", unt,
                           " : ",
                           monn_full)
    }

    if (parr == "prcp") {
      y_axis_lab <- paste0(parr, " average anomaly (% of normal)")
    } else{
      y_axis_lab <- paste0(parr, " average anomaly ", unt)
    }

    ano_shp_trn_plt <-
      ggplot(data = ano_shp_av_dt, aes(x = yr, y = ano)) +
      annotate(
        geom = 'text',
        label = plt_wtrmrk,
        x = Inf,
        y = -Inf,
        hjust = 1,
        vjust = -0.3,
        color = 'gray80',
        size = 3,
        alpha = 0.8
      ) +
      geom_bar(
        stat = "identity",
        aes(fill = ano),
        width = 0.7,
        show.legend = FALSE
      ) +
      geom_hline(
        yintercept = 0,
        color = "gray10",
        linewidth = 0.5
      ) +
      scale_fill_gradientn(
        name = paste0(parr, " anomaly ", unt),
        colours = cpt(pal = "ncl_BlWhRe",
                      n = 100,
                      rev = F),
        limits = c(ymin, ymax),
        breaks = ybrks_seq
      ) +
      geom_line(
        aes(y = ano_mv, color = "3 years moving average"),
        linewidth = 1.1,
        alpha = 0.7,
        na.rm = T
      ) +
      # geom_point(color = "blue", size = 2) +
      geom_segment(
        aes(
          x = xs[[1]],
          xend = xs[[2]],
          y = ys[[1]],
          yend = ys[[2]],
          color = "1950-trend line"
        ),
        linetype = "dashed",
        linewidth = 0.9
      ) +
      geom_label(
        aes(x = xs[[1]] + 20),
        color = 'deepskyblue',
        y = ymax - 0.05,
        fill = NA,
        label = ano_shp_av_dt$trn_lab[[1]],
        size = 4.0,
        parse = TRUE
      ) +
      # add 80s trend
      geom_segment(
        aes(
          x = xs80[[1]],
          xend = xs80[[2]],
          y = ys80[[1]],
          yend = ys80[[2]],
          color = "1980-trend line"
        ),
        linetype = "solid",
        linewidth = 0.9
      ) +
      geom_label(
        aes(x = xs[[1]] + 38),
        y = ymax - 0.05,
        fill = NA,
        color = 'black',
        label = ano_shp_av_dt80$trn_lab[[1]],
        size = 4.0,
        parse = TRUE
      ) +
      scale_x_continuous(
        name = " ",
        breaks = seq(minyr, maxyr, 3),
        expand = c(0.02, 0.02)
      ) +
      scale_y_continuous(name = y_axis_lab,
                         limits = c(ymin, ymax),
                         breaks = ybrks_seq) +
      labs(title = par_title, subtitle = "Baseline: 1981-2010") +
      scale_color_manual(
        " ",
        values = c(
          "3 years moving average" = "green",
          "1950-trend line" = "deepskyblue",
          "1980-trend line" = "black"
        ),
        labels =  c(
          "3 years moving average" = "3-years moving \n mean",
          "1950-trend line" = "1950-trend",
          "1980-trend line" = "1980-trend"
        )
      ) +
      theme_bw() +
      theme(
        # panel.spacing=unit(0.1,"lines"),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_line(
          color = "gray75",
          linewidth = 0.05,
          linetype = "dashed"
        ),
        axis.line = element_line(colour = "black", linewidth = 1),
        axis.ticks.length = unit(-0.20, "cm"),
        element_line(colour = "black", linewidth =  1),
        axis.title.y = element_text(
          angle = 90,
          face = "plain",
          size = 14,
          colour = "Black",
          margin = unit(c(1, 1, 1, 1), "mm")
        ),
        axis.title.x = element_text(
          angle = 0,
          face = "plain",
          size = 14,
          colour = "Black",
          margin = unit(c(1, 1, 1, 1), "mm")
        ),
        axis.text.x = element_text(
          angle = 0,
          hjust = 0.5,
          vjust = 0.5,
          colour = "black",
          size = 13,
          margin = margin(
            t = 2,
            r = 2,
            b = 2,
            l = 2
          )
        ),
        axis.text.y = element_text(
          angle = 90,
          hjust = 0.5,
          vjust = 0.5,
          colour = "black",
          size = 13,
          margin = margin(
            t = 2,
            r = 2,
            b = 2,
            l = 2
          )
        ),
        plot.title = element_text(
          angle = 0,
          face = "bold",
          size = 14,
          colour = "Black"
        ),
        legend.position = c(0.09, 0.95),
        legend.direction = "vertical",
        legend.background = element_rect(fill = NA, color = NA),
        legend.margin = margin(0, 0, 0, 0),
        legend.box.margin = margin(0, 0, 0, 0),
        legend.title = element_text(size = 13),
        legend.text = element_text(margin = margin(t = -5), size = 12),
        strip.text.x = element_text(size = 12, angle = 0),
        strip.text.y = element_text(size = 12, face = "bold"),
        axis.text = element_text(margin = -5),
        strip.background = element_rect(fill = "black"),
        strip.text = element_text(colour = 'Black')
      )
    ano_shp_trn_plt
    if (parr == "prcp") {
      ano_shp_trn_plt <- ano_shp_trn_plt +
        scale_fill_gradientn(
          name = paste0(parr_pr, "  anomaly ", unt),
          colours = cpt(pal = "cmocean_curl",
                        n = 100,
                        rev = T),
          limits = c(ymin, ymax),
          breaks = ybrks_seq
        )
    }
    # ano_shp_trn_plt
    
    # ggsave(
    #   paste0(
    #     results_pth,
    #     parr,
    #     "_",
    #     mon,
    #     "_spatial_average_anomaly_",
    #     xs[1],
    #     "_",
    #     xs[2],
    #     "_",sel_area,
    #     ".png"
    #   ),
    #   plot = ano_shp_trn_plt,
    #   width = 13,
    #   height = 6,
    #   units = "in",
    #   dpi = 300,
    #   scale = 0.9,
    #   limitsize = F
    # )
    
    # To include in the list with name
    plts <- list( spatial_ano_plt,ano_shp_trn_plt)
    names(plts) <- c(paste0(parr,"_",monn,"_anomaly"),
                    paste0(parr,"_",monn,"_spatial_average_anomaly"))
    
    return(plts)
  }
}

```

# Monthly anomaly : January

## Mean Temperature

```{r plt_gen_Jan_tmean}
#| include: false
#| cache: true

monn <- "Jan"
parr <- "tmean"

full_month <- month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

tmn_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
tmn_ano_plt_lst
```

```{r ano_plt_Jan_tmean}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_Jan_tmean
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
tmn_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_Jan_tmean}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_Jan_tmean
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
tmn_ano_plt_lst[[1]][[2]]
```

## Total Precipitation

```{r plt_gen_Jan_prcp}
#| include: false
#| cache: true

monn <- "Jan"
parr <- "prcp"

full_month <- month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

prcp_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
prcp_ano_plt_lst
```

```{r ano_plt_Jan_prcp}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_Jan_prcp
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
prcp_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_Jan_prcp}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_Jan_prcp
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
prcp_ano_plt_lst[[1]][[2]]
```

## Maximum Temperature

```{r plt_gen_Jan_tmax}
#| include: false
#| cache: true

monn <- "Jan"
parr <- "tmax"

full_month <- month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

tmx_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
tmx_ano_plt_lst
```

```{r ano_plt_Jan_tmax}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_Jan_tmax
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
tmx_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_Jan_tmax}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_Jan_tmax
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
tmx_ano_plt_lst[[1]][[2]]
```

## Minimum Temperature

```{r plt_gen_Jan_tmin}
#| include: false
#| cache: true

monn <- "Jan"
parr <- "tmin"

full_month <- month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

tmi_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
tmi_ano_plt_lst
```

```{r ano_plt_Jan_tmin}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_Jan_tmin
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
tmi_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_Jan_tmin}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_Jan_tmin
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
tmi_ano_plt_lst[[1]][[2]]
```

# Monthly anomaly : February

## Mean Temperature

```{r plt_gen_Feb_tmean}
#| include: false
#| cache: true

monn <- "Feb"
parr <- "tmean"

full_month <- month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

tmn_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
tmn_ano_plt_lst
```

```{r ano_plt_Feb_tmean}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_Feb_tmean
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
tmn_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_Feb_tmean}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_Feb_tmean
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
tmn_ano_plt_lst[[1]][[2]]
```

## Total Precipitation

```{r plt_gen_Feb_prcp}
#| include: false
#| cache: true

monn <- "Feb"
parr <- "prcp"

full_month <- month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

prcp_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
prcp_ano_plt_lst
```

```{r ano_plt_Feb_prcp}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_Feb_prcp
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
prcp_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_Feb_prcp}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_Feb_prcp
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
prcp_ano_plt_lst[[1]][[2]]
```

## Maximum Temperature

```{r plt_gen_Feb_tmax}
#| include: false
#| cache: true

monn <- "Feb"
parr <- "tmax"

full_month <- month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

tmx_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
tmx_ano_plt_lst
```

```{r ano_plt_Feb_tmax}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_Feb_tmax
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
tmx_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_Feb_tmax}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_Feb_tmax
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
tmx_ano_plt_lst[[1]][[2]]
```

## Minimum Temperature

```{r plt_gen_Feb_tmin}
#| include: false
#| cache: true

monn <- "Feb"
parr <- "tmin"

full_month <- month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

tmi_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
tmi_ano_plt_lst
```

```{r ano_plt_Feb_tmin}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_Feb_tmin
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
tmi_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_Feb_tmin}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_Feb_tmin
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
tmi_ano_plt_lst[[1]][[2]]
```

# Monthly anomaly : March

## Mean Temperature

```{r plt_gen_Mar_tmean}
#| include: false
#| cache: true

monn <- "Mar"
parr <- "tmean"

full_month <- month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

tmn_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
tmn_ano_plt_lst
```

```{r ano_plt_Mar_tmean}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_Mar_tmean
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
tmn_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_Mar_tmean}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_Mar_tmean
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
tmn_ano_plt_lst[[1]][[2]]
```

## Total Precipitation

```{r plt_gen_Mar_prcp}
#| include: false
#| cache: true

monn <- "Mar"
parr <- "prcp"

full_month <- month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

prcp_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
prcp_ano_plt_lst
```

```{r ano_plt_Mar_prcp}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_Mar_prcp
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
prcp_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_Mar_prcp}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_Mar_prcp
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
prcp_ano_plt_lst[[1]][[2]]
```

## Maximum Temperature

```{r plt_gen_Mar_tmax}
#| include: false
#| cache: true

monn <- "Mar"
parr <- "tmax"

full_month <- month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

tmx_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
tmx_ano_plt_lst
```

```{r ano_plt_Mar_tmax}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_Mar_tmax
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
tmx_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_Mar_tmax}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_Mar_tmax
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
tmx_ano_plt_lst[[1]][[2]]
```

## Minimum Temperature

```{r plt_gen_Mar_tmin}
#| include: false
#| cache: true

monn <- "Mar"
parr <- "tmin"

full_month <- month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

tmi_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
tmi_ano_plt_lst
```

```{r ano_plt_Mar_tmin}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_Mar_tmin
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
tmi_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_Mar_tmin}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_Mar_tmin
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
tmi_ano_plt_lst[[1]][[2]]
```

# Monthly anomaly : April

## Mean Temperature

```{r plt_gen_Apr_tmean}
#| include: false
#| cache: true

monn <- "Apr"
parr <- "tmean"

full_month <- month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

tmn_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
tmn_ano_plt_lst
```

```{r ano_plt_Apr_tmean}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_Apr_tmean
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
tmn_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_Apr_tmean}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_Apr_tmean
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
tmn_ano_plt_lst[[1]][[2]]
```

## Total Precipitation

```{r plt_gen_Apr_prcp}
#| include: false
#| cache: true

monn <- "Apr"
parr <- "prcp"

full_month <- month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

prcp_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
prcp_ano_plt_lst
```

```{r ano_plt_Apr_prcp}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_Apr_prcp
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
prcp_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_Apr_prcp}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_Apr_prcp
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
prcp_ano_plt_lst[[1]][[2]]
```

## Maximum Temperature

```{r plt_gen_Apr_tmax}
#| include: false
#| cache: true

monn <- "Apr"
parr <- "tmax"

full_month <- month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

tmx_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
tmx_ano_plt_lst
```

```{r ano_plt_Apr_tmax}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_Apr_tmax
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
tmx_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_Apr_tmax}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_Apr_tmax
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
tmx_ano_plt_lst[[1]][[2]]
```

## Minimum Temperature

```{r plt_gen_Apr_tmin}
#| include: false
#| cache: true

monn <- "Apr"
parr <- "tmin"

full_month <- month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

tmi_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
tmi_ano_plt_lst
```

```{r ano_plt_Apr_tmin}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_Apr_tmin
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
tmi_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_Apr_tmin}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_Apr_tmin
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
tmi_ano_plt_lst[[1]][[2]]
```

# Monthly anomaly : May

## Mean Temperature

```{r plt_gen_May_tmean}
#| include: false
#| cache: true

monn <- "May"
parr <- "tmean"

full_month <- month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

tmn_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
tmn_ano_plt_lst
```

```{r ano_plt_May_tmean}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_May_tmean
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
tmn_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_May_tmean}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_May_tmean
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
tmn_ano_plt_lst[[1]][[2]]
```

## Total Precipitation

```{r plt_gen_May_prcp}
#| include: false
#| cache: true

monn <- "May"
parr <- "prcp"

full_month <- month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

prcp_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
prcp_ano_plt_lst
```

```{r ano_plt_May_prcp}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_May_prcp
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
prcp_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_May_prcp}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_May_prcp
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
prcp_ano_plt_lst[[1]][[2]]
```

## Maximum Temperature

```{r plt_gen_May_tmax}
#| include: false
#| cache: true

monn <- "May"
parr <- "tmax"

full_month <- month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

tmx_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
tmx_ano_plt_lst
```

```{r ano_plt_May_tmax}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_May_tmax
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
tmx_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_May_tmax}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_May_tmax
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
tmx_ano_plt_lst[[1]][[2]]
```

## Minimum Temperature

```{r plt_gen_May_tmin}
#| include: false
#| cache: true

monn <- "May"
parr <- "tmin"

full_month <- month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

tmi_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
tmi_ano_plt_lst
```

```{r ano_plt_May_tmin}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_May_tmin
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
tmi_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_May_tmin}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_May_tmin
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
tmi_ano_plt_lst[[1]][[2]]
```

# Monthly anomaly : June

## Mean Temperature

```{r plt_gen_Jun_tmean}
#| include: false
#| cache: true

monn <- "Jun"
parr <- "tmean"

full_month <- month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

tmn_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
tmn_ano_plt_lst
```

```{r ano_plt_Jun_tmean}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_Jun_tmean
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
tmn_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_Jun_tmean}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_Jun_tmean
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
tmn_ano_plt_lst[[1]][[2]]
```

## Total Precipitation

```{r plt_gen_Jun_prcp}
#| include: false
#| cache: true

monn <- "Jun"
parr <- "prcp"

full_month <- month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

prcp_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
prcp_ano_plt_lst
```

```{r ano_plt_Jun_prcp}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_Jun_prcp
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
prcp_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_Jun_prcp}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_Jun_prcp
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
prcp_ano_plt_lst[[1]][[2]]
```

## Maximum Temperature

```{r plt_gen_Jun_tmax}
#| include: false
#| cache: true

monn <- "Jun"
parr <- "tmax"

full_month <- month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

tmx_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
tmx_ano_plt_lst
```

```{r ano_plt_Jun_tmax}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_Jun_tmax
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
tmx_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_Jun_tmax}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_Jun_tmax
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
tmx_ano_plt_lst[[1]][[2]]
```

## Minimum Temperature

```{r plt_gen_Jun_tmin}
#| include: false
#| cache: true

monn <- "Jun"
parr <- "tmin"

full_month <- month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

tmi_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
tmi_ano_plt_lst
```

```{r ano_plt_Jun_tmin}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_Jun_tmin
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
tmi_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_Jun_tmin}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_Jun_tmin
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
tmi_ano_plt_lst[[1]][[2]]
```

# Monthly anomaly : July

## Mean Temperature

```{r plt_gen_Jul_tmean}
#| include: false
#| cache: true

monn <- "Jul"
parr <- "tmean"

full_month <- month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

tmn_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
tmn_ano_plt_lst
```

```{r ano_plt_Jul_tmean}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_Jul_tmean
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
tmn_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_Jul_tmean}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_Jul_tmean
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
tmn_ano_plt_lst[[1]][[2]]
```

## Total Precipitation

```{r plt_gen_Jul_prcp}
#| include: false
#| cache: true

monn <- "Jul"
parr <- "prcp"

full_month <- month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

prcp_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
prcp_ano_plt_lst
```

```{r ano_plt_Jul_prcp}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_Jul_prcp
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
prcp_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_Jul_prcp}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_Jul_prcp
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
prcp_ano_plt_lst[[1]][[2]]
```

## Maximum Temperature

```{r plt_gen_Jul_tmax}
#| include: false
#| cache: true

monn <- "Jul"
parr <- "tmax"

full_month <- month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

tmx_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
tmx_ano_plt_lst
```

```{r ano_plt_Jul_tmax}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_Jul_tmax
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
tmx_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_Jul_tmax}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_Jul_tmax
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
tmx_ano_plt_lst[[1]][[2]]
```

## Minimum Temperature

```{r plt_gen_Jul_tmin}
#| include: false
#| cache: true

monn <- "Jul"
parr <- "tmin"

full_month <- month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

tmi_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
tmi_ano_plt_lst
```

```{r ano_plt_Jul_tmin}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_Jul_tmin
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
tmi_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_Jul_tmin}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_Jul_tmin
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
tmi_ano_plt_lst[[1]][[2]]
```

# Monthly anomaly : August

## Mean Temperature

```{r plt_gen_Aug_tmean}
#| include: false
#| cache: true

monn <- "Aug"
parr <- "tmean"

full_month <- month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

tmn_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
tmn_ano_plt_lst
```

```{r ano_plt_Aug_tmean}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_Aug_tmean
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
tmn_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_Aug_tmean}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_Aug_tmean
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
tmn_ano_plt_lst[[1]][[2]]
```

## Total Precipitation

```{r plt_gen_Aug_prcp}
#| include: false
#| cache: true

monn <- "Aug"
parr <- "prcp"

full_month <- month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

prcp_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
prcp_ano_plt_lst
```

```{r ano_plt_Aug_prcp}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_Aug_prcp
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
prcp_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_Aug_prcp}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_Aug_prcp
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
prcp_ano_plt_lst[[1]][[2]]
```

## Maximum Temperature

```{r plt_gen_Aug_tmax}
#| include: false
#| cache: true

monn <- "Aug"
parr <- "tmax"

full_month <- month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

tmx_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
tmx_ano_plt_lst
```

```{r ano_plt_Aug_tmax}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_Aug_tmax
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
tmx_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_Aug_tmax}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_Aug_tmax
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
tmx_ano_plt_lst[[1]][[2]]
```

## Minimum Temperature

```{r plt_gen_Aug_tmin}
#| include: false
#| cache: true

monn <- "Aug"
parr <- "tmin"

full_month <- month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

tmi_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
tmi_ano_plt_lst
```

```{r ano_plt_Aug_tmin}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_Aug_tmin
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
tmi_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_Aug_tmin}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_Aug_tmin
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
tmi_ano_plt_lst[[1]][[2]]
```

# Monthly anomaly : September

## Mean Temperature

```{r plt_gen_Sep_tmean}
#| include: false
#| cache: true

monn <- "Sep"
parr <- "tmean"

full_month <- month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

tmn_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
tmn_ano_plt_lst
```

```{r ano_plt_Sep_tmean}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_Sep_tmean
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
tmn_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_Sep_tmean}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_Sep_tmean
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
tmn_ano_plt_lst[[1]][[2]]
```

## Total Precipitation

```{r plt_gen_Sep_prcp}
#| include: false
#| cache: true

monn <- "Sep"
parr <- "prcp"

full_month <- month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

prcp_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
prcp_ano_plt_lst
```

```{r ano_plt_Sep_prcp}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_Sep_prcp
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
prcp_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_Sep_prcp}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_Sep_prcp
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
prcp_ano_plt_lst[[1]][[2]]
```

## Maximum Temperature

```{r plt_gen_Sep_tmax}
#| include: false
#| cache: true

monn <- "Sep"
parr <- "tmax"

full_month <- month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

tmx_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
tmx_ano_plt_lst
```

```{r ano_plt_Sep_tmax}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_Sep_tmax
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
tmx_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_Sep_tmax}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_Sep_tmax
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
tmx_ano_plt_lst[[1]][[2]]
```

## Minimum Temperature

```{r plt_gen_Sep_tmin}
#| include: false
#| cache: true

monn <- "Sep"
parr <- "tmin"

full_month <- month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

tmi_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
tmi_ano_plt_lst
```

```{r ano_plt_Sep_tmin}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_Sep_tmin
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
tmi_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_Sep_tmin}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_Sep_tmin
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
tmi_ano_plt_lst[[1]][[2]]
```

# Monthly anomaly : November

## Mean Temperature

```{r plt_gen_Nov_tmean}
#| include: false
#| cache: true

monn <- "Nov"
parr <- "tmean"

full_month <- month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

tmn_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
tmn_ano_plt_lst
```

```{r ano_plt_Nov_tmean}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_Nov_tmean
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
tmn_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_Nov_tmean}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_Nov_tmean
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
tmn_ano_plt_lst[[1]][[2]]
```

## Total Precipitation

```{r plt_gen_Nov_prcp}
#| include: false
#| cache: true

monn <- "Nov"
parr <- "prcp"

full_month <- month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

prcp_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
prcp_ano_plt_lst
```

```{r ano_plt_Nov_prcp}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_Nov_prcp
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
prcp_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_Nov_prcp}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_Nov_prcp
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
prcp_ano_plt_lst[[1]][[2]]
```

## Maximum Temperature

```{r plt_gen_Nov_tmax}
#| include: false
#| cache: true

monn <- "Nov"
parr <- "tmax"

full_month <- month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

tmx_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
tmx_ano_plt_lst
```

```{r ano_plt_Nov_tmax}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_Nov_tmax
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
tmx_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_Nov_tmax}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_Nov_tmax
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
tmx_ano_plt_lst[[1]][[2]]
```

## Minimum Temperature

```{r plt_gen_Nov_tmin}
#| include: false
#| cache: true

monn <- "Nov"
parr <- "tmin"

full_month <- month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

tmi_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
tmi_ano_plt_lst
```

```{r ano_plt_Nov_tmin}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_Nov_tmin
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
tmi_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_Nov_tmin}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_Nov_tmin
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
tmi_ano_plt_lst[[1]][[2]]
```

# Monthly anomaly : December

## Mean Temperature

```{r plt_gen_Dec_tmean}
#| include: false
#| cache: true

monn <- "Dec"
parr <- "tmean"

full_month <- month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

tmn_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
tmn_ano_plt_lst
```

```{r ano_plt_Dec_tmean}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_Dec_tmean
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
tmn_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_Dec_tmean}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_Dec_tmean
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
tmn_ano_plt_lst[[1]][[2]]
```

## Total Precipitation

```{r plt_gen_Dec_prcp}
#| include: false
#| cache: true

monn <- "Dec"
parr <- "prcp"

full_month <- month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

prcp_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
prcp_ano_plt_lst
```

```{r ano_plt_Dec_prcp}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_Dec_prcp
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
prcp_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_Dec_prcp}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_Dec_prcp
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
prcp_ano_plt_lst[[1]][[2]]
```

## Maximum Temperature

```{r plt_gen_Dec_tmax}
#| include: false
#| cache: true

monn <- "Dec"
parr <- "tmax"

full_month <- month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

tmx_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
tmx_ano_plt_lst
```

```{r ano_plt_Dec_tmax}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_Dec_tmax
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
tmx_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_Dec_tmax}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_Dec_tmax
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
tmx_ano_plt_lst[[1]][[2]]
```

## Minimum Temperature

```{r plt_gen_Dec_tmin}
#| include: false
#| cache: true

monn <- "Dec"
parr <- "tmin"

full_month <- month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

tmi_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
tmi_ano_plt_lst
```

```{r ano_plt_Dec_tmin}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_Dec_tmin
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
tmi_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_Dec_tmin}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_Dec_tmin
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
tmi_ano_plt_lst[[1]][[2]]
```

# Winter anomaly

## Mean Temperature

```{r plt_gen_winter_tmean}
#| include: false
#| cache: true

monn <- "winter"
parr <- "tmean"

full_month <- "Winter"#month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

tmn_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
tmn_ano_plt_lst
```

```{r ano_plt_winter_tmean}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_winter_tmean
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
tmn_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_winter_tmean}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_winter_tmean
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
tmn_ano_plt_lst[[1]][[2]]
```

## Total Precipitation

```{r plt_gen_winter_prcp}
#| include: false
#| cache: true

monn <- "winter"
parr <- "prcp"

full_month <- "winter"#month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

prcp_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
prcp_ano_plt_lst
```

```{r ano_plt_winter_prcp}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_winter_prcp
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
prcp_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_winter_prcp}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_winter_prcp
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
prcp_ano_plt_lst[[1]][[2]]
```

## Maximum Temperature

```{r plt_gen_winter_tmax}
#| include: false
#| cache: true

monn <- "winter"
parr <- "tmax"

full_month <- "winter"#month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

tmx_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
tmx_ano_plt_lst
```

```{r ano_plt_winter_tmax}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_winter_tmax
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
tmx_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_winter_tmax}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_winter_tmax
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
tmx_ano_plt_lst[[1]][[2]]
```

## Minimum Temperature

```{r plt_gen_winter_tmin}
#| include: false
#| cache: true

monn <- "winter"
parr <- "tmin"

full_month <- "winter"#month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

tmi_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
tmi_ano_plt_lst
```

```{r ano_plt_winter_tmin}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_winter_tmin
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
tmi_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_winter_tmin}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_winter_tmin
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
tmi_ano_plt_lst[[1]][[2]]
```

# Spring anomaly

## Mean Temperature

```{r plt_gen_spring_tmean}
#| include: false
#| cache: true

monn <- "spring"
parr <- "tmean"

full_month <- "Spring"#month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

tmn_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
tmn_ano_plt_lst
```

```{r ano_plt_spring_tmean}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_spring_tmean
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
tmn_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_spring_tmean}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_spring_tmean
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
tmn_ano_plt_lst[[1]][[2]]
```

## Total Precipitation

```{r plt_gen_spring_prcp}
#| include: false
#| cache: true

monn <- "spring"
parr <- "prcp"

full_month <- "spring"#month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

prcp_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
prcp_ano_plt_lst
```

```{r ano_plt_spring_prcp}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_spring_prcp
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
prcp_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_spring_prcp}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_spring_prcp
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
prcp_ano_plt_lst[[1]][[2]]
```

## Maximum Temperature

```{r plt_gen_spring_tmax}
#| include: false
#| cache: true

monn <- "spring"
parr <- "tmax"

full_month <- "spring"#month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

tmx_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
tmx_ano_plt_lst
```

```{r ano_plt_spring_tmax}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_spring_tmax
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
tmx_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_spring_tmax}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_spring_tmax
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
tmx_ano_plt_lst[[1]][[2]]
```

## Minimum Temperature

```{r plt_gen_spring_tmin}
#| include: false
#| cache: true

monn <- "spring"
parr <- "tmin"

full_month <- "spring"#month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

tmi_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
tmi_ano_plt_lst
```

```{r ano_plt_spring_tmin}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_spring_tmin
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
tmi_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_spring_tmin}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_spring_tmin
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
tmi_ano_plt_lst[[1]][[2]]
```

# Summer anomaly

## Mean Temperature

```{r plt_gen_summer_tmean}
#| include: false
#| cache: true

monn <- "summer"
parr <- "tmean"

full_month <- "Summer"#month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

tmn_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
tmn_ano_plt_lst
```

```{r ano_plt_summer_tmean}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_summer_tmean
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
tmn_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_summer_tmean}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_summer_tmean
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
tmn_ano_plt_lst[[1]][[2]]
```

## Total Precipitation

```{r plt_gen_summer_prcp}
#| include: false
#| cache: true

monn <- "summer"
parr <- "prcp"

full_month <- "summer"#month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

prcp_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
prcp_ano_plt_lst
```

```{r ano_plt_summer_prcp}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_summer_prcp
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
prcp_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_summer_prcp}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_summer_prcp
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
prcp_ano_plt_lst[[1]][[2]]
```

## Maximum Temperature

```{r plt_gen_summer_tmax}
#| include: false
#| cache: true

monn <- "summer"
parr <- "tmax"

full_month <- "summer"#month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

tmx_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
tmx_ano_plt_lst
```

```{r ano_plt_summer_tmax}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_summer_tmax
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
tmx_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_summer_tmax}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_summer_tmax
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
tmx_ano_plt_lst[[1]][[2]]
```

## Minimum Temperature

```{r plt_gen_summer_tmin}
#| include: false
#| cache: true

monn <- "summer"
parr <- "tmin"

full_month <- "summer"#month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

tmi_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
tmi_ano_plt_lst
```

```{r ano_plt_summer_tmin}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_summer_tmin
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
tmi_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_summer_tmin}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_summer_tmin
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
tmi_ano_plt_lst[[1]][[2]]
```

# Fall anomaly

## Mean Temperature

```{r plt_gen_fall_tmean}
#| include: false
#| cache: true

monn <- "fall"
parr <- "tmean"

full_month <- "Fall"#month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

tmn_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
tmn_ano_plt_lst
```

```{r ano_plt_fall_tmean}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_fall_tmean
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
tmn_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_fall_tmean}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_fall_tmean
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
tmn_ano_plt_lst[[1]][[2]]
```

## Total Precipitation

```{r plt_gen_fall_prcp}
#| include: false
#| cache: true

monn <- "fall"
parr <- "prcp"

full_month <- "fall"#month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

prcp_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
prcp_ano_plt_lst
```

```{r ano_plt_fall_prcp}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_fall_prcp
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
prcp_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_fall_prcp}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_fall_prcp
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
prcp_ano_plt_lst[[1]][[2]]
```

## Maximum Temperature

```{r plt_gen_fall_tmax}
#| include: false
#| cache: true

monn <- "fall"
parr <- "tmax"

full_month <- "fall"#month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

tmx_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
tmx_ano_plt_lst
```

```{r ano_plt_fall_tmax}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_fall_tmax
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
tmx_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_fall_tmax}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_fall_tmax
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
tmx_ano_plt_lst[[1]][[2]]
```

## Minimum Temperature

```{r plt_gen_fall_tmin}
#| include: false
#| cache: true

monn <- "fall"
parr <- "tmin"

full_month <- "fall"#month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

tmi_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
tmi_ano_plt_lst
```

```{r ano_plt_fall_tmin}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_fall_tmin
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
tmi_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_fall_tmin}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_fall_tmin
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
tmi_ano_plt_lst[[1]][[2]]
```

# Annual anomaly

## Mean Temperature

```{r plt_gen_annual_tmean}
#| include: false
#| cache: true

monn <- "annual"
parr <- "tmean"

full_month <- "Annual"#month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

tmn_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
tmn_ano_plt_lst
```

```{r ano_plt_annual_tmean}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_annual_tmean
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
tmn_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_annual_tmean}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_annual_tmean
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
tmn_ano_plt_lst[[1]][[2]]
```

## Total Precipitation

```{r plt_gen_annual_prcp}
#| include: false
#| cache: true

monn <- "annual"
parr <- "prcp"

full_month <- "Annual"#month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

prcp_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
prcp_ano_plt_lst
```

```{r ano_plt_annual_prcp}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_annual_prcp
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
prcp_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_annual_prcp}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_annual_prcp
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
prcp_ano_plt_lst[[1]][[2]]
```

## Maximum Temperature

```{r plt_gen_annual_tmax}
#| include: false
#| cache: true

monn <- "annual"
parr <- "tmax"

full_month <- "Annual"#month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

tmx_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
tmx_ano_plt_lst
```

```{r ano_plt_annual_tmax}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_annual_tmax
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
tmx_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_annual_tmax}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_annual_tmax
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
tmx_ano_plt_lst[[1]][[2]]
```

## Minimum Temperature

```{r plt_gen_annual_tmin}
#| include: false
#| cache: true

monn <- "annual"
parr <- "tmin"

full_month <- "Annual"#month.name[match(monn, month.abb)]
# Parameters names for plot captions
if (parr == "tmax" ) {
  par_nam <- 'monthly maximum temperature'
} else if (parr == "tmin" ) {
  par_nam <- 'monthly minimum temperature'
} else if (parr == "tmean"){
  par_nam <- 'monthly average temperature'
} else if (parr == "prcp") {
  par_nam <- 'monthly total precipitation'
}
par_nam

ano_dt_fl%>%
  dplyr::filter(mon==monn & par==parr) ->  ano_dt_fl_mp
ano_dt_fl_mp

tmi_ano_plt_lst <- list(
  ano_ana_plt_fun(ano_dt_fls=ano_dt_fl_mp,
                  spatial_plt = T,
                  spatial_av = T,
                  test_plt = F))
tmi_ano_plt_lst
```

```{r ano_plt_annual_tmin}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 9.5
#| fig-width: 15
#| label: fig-ano_plt_annual_tmin
#| fig-cap: !expr paste("Spatial distribution of ",par_nam,"anomalies relative to the 1980 - 2010 mean:",full_month)
tmi_ano_plt_lst[[1]][[1]]
```

```{r sp_av_ano_plt_annual_tmin}
#| include: true
#| output: true
#| cache: true
#| fig-align: left
#| fig-height: 6.5
#| fig-width: 14
#| label: fig-sp_av_ano_plt_annual_tmin
#| fig-cap: !expr paste("Spatially averaged",par_nam,"anomalies and trend for BC:",full_month,". The inset box indicates trend magnitude and significance for 1950 and 1980 to present year.")
tmi_ano_plt_lst[[1]][[2]]
```
